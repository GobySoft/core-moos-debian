--- a/Core/libMOOS/App/include/MOOS/libMOOS/App/MOOSApp.h
+++ b/Core/libMOOS/App/include/MOOS/libMOOS/App/MOOSApp.h
@@ -41,6 +41,7 @@
 #include "MOOS/libMOOS/Comms/MOOSCommClient.h"
 #include "MOOS/libMOOS/Comms/MOOSVariable.h"
 
+#include "MOOS/libMOOS/App/ClientDefines.h"
 
 #include <set>
 #include <map>
--- a/Core/libMOOS/CMakeLists.txt
+++ b/Core/libMOOS/CMakeLists.txt
@@ -95,17 +95,10 @@
 #do we want to use the new fast asynchronous client architecture?
 OPTION(USE_ASYNC_COMMS  "enable fast asynchronous comms architecture" ON)
 IF (USE_ASYNC_COMMS)
-    cache_internal_append_unique(PROJECT_EXPORT_DEFINES ASYNCHRONOUS_CLIENT)
-    ADD_DEFINITIONS(-DASYNCHRONOUS_CLIENT)
-ELSE (USE_ASYNC_COMMS)
-    message(STATUS "removing ASYNCHRONOUS_CLIENT")
-    cache_internal_remove(PROJECT_EXPORT_DEFINES ASYNCHRONOUS_CLIENT)
-    REMOVE_DEFINITIONS(-DASYNCHRONOUS_CLIENT)
+  set(ASYNCHRONOUS_CLIENT_DEFINE "#define ASYNCHRONOUS_CLIENT")
 ENDIF (USE_ASYNC_COMMS)
 
 
-
-
 #do we want to turn on the experimental clock skew detection?
 OPTION(DETECT_CLOCK_DRIFT  "MOOSCommClient<->MOOSDB Clock drift detection (experimental)" OFF)
 IF (DETECT_CLOCK_DRIFT)
@@ -149,6 +142,8 @@
     ENDIF()
 ENDIF ()
 
+CONFIGURE_FILE(${CMAKE_MODULE_PATH}/ClientDefines.h.in
+${CMAKE_CURRENT_SOURCE_DIR}/App/include/MOOS/libMOOS/App/ClientDefines.h @ONLY)
 
 
 ##########################
--- /dev/null
+++ b/cmake/ClientDefines.h.in
@@ -0,0 +1,3 @@
+#pragma once
+//this file is auto generated and defines various preprocessor macros needed by the CMOOSApp
+@ASYNCHRONOUS_CLIENT_DEFINE@
